<Page x:Class="Pet_Shop_Project.Views.OQPSuccess"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:Pet_Shop_Project.Views"
      xmlns:services="clr-namespace:Pet_Shop_Project.Services"
      mc:Ignorable="d" 
      d:DesignHeight="487" d:DesignWidth="920"
      Title="OQPSuccess"
      Background="White">

    <Page.Resources>
        <services:ConvertLanguage x:Key="LangConverter"/>
    </Page.Resources>

    <Grid Margin="5">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="30,10,0,0">
            <TextBlock Text="Tổng Số Đơn Hàng Đã Giao Thành Công: " FontWeight="Bold" FontSize="15"/>
            <TextBlock Text="{Binding TotalSuccess}" FontSize="15"/>
        </StackPanel>

        <ScrollViewer Grid.Row="1"
          VerticalScrollBarVisibility="Auto" 
          Margin="20"
          Background="Transparent">
            <ScrollViewer.Resources>
                <Style TargetType="ScrollBar">
                    <Setter Property="Width" Value="6"/>
                    <Setter Property="Background" Value="Transparent"/>
                    <Setter Property="BorderThickness" Value="0"/>
                </Style>
            </ScrollViewer.Resources>
            <ItemsControl ItemsSource="{Binding OrderSuccesses}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <Border Style="{StaticResource TemplateODQ}">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="0 0 0 8">
                                    <TextBlock Text="Mã đơn hàng: " FontWeight="Bold" Foreground="Blue"/>
                                    <TextBlock Text="{Binding OrderId}" Margin="4,0"/>
                                    <TextBlock Text="    Ngày đặt: " FontWeight="Bold" Margin="10,0,0,0"/>
                                    <TextBlock Text="{Binding OrderDate, StringFormat='{}{0:dd/MM/yyyy HH:mm}'}" Margin="4,0"/>
                                    <TextBlock Text="    Tổng tiền: " FontWeight="Bold" />
                                    <TextBlock Text="{Binding TotalAmount, StringFormat='{}{0:N0} ₫'}" Margin="4,0" Foreground="Red"/>
                                    <TextBlock Text="    Thanh toán: " FontWeight="Bold"/>
                                    <TextBlock Text="{Binding PaymentStatus, Converter={StaticResource LangConverter}}" Margin="4,0"/>
                                    <TextBlock Text="    Vận chuyển: " FontWeight="Bold" Margin="10,0,0,0"/>
                                    <TextBlock Text="{Binding ShippingStatus, Converter={StaticResource LangConverter}}" Margin="4,0"/>
                                </StackPanel>

                                <!-- Danh sách sản phẩm -->
                                <ItemsControl ItemsSource="{Binding Details}">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border BorderBrush="#FFC476" BorderThickness="1" CornerRadius="6" Padding="8" Margin="0 0 0 5">
                                                <DockPanel>
                                                    <Image Source="{Binding Product.Picture}" Width="60" Height="60" Stretch="UniformToFill" Margin="0 0 10 0"/>
                                                    <StackPanel>
                                                        <TextBlock Text="{Binding Product.Name}" FontWeight="Bold"/>
                                                        <TextBlock Text="{Binding Product.Description}" FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap" MaxWidth="600"/>
                                                        <TextBlock>
                                                        <Run Text="Số lượng: "/>
                                                        <Run Text="{Binding Quantity}"/>
                                                        <Run Text=" | Giá: "/>
                                                        <Run Text="{Binding Product.UnitPrice, StringFormat='{}{0:N0} ₫'}"/>
                                                        <Run Text=" | Giảm: "/>
                                                        <Run Text="{Binding Product.Discount, StringFormat='{}{0:P0}'}"/>
                                                        </TextBlock>
                                                    </StackPanel>
                                                </DockPanel>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </Border>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </Grid>
</Page>
